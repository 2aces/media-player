{"version":3,"file":"media-player.js","sources":["../media-player.js"],"sourcesContent":["/* Media Player\n/* ====================================================================== */\n\nexport default function MediaPlayer(media, rawopts) { // eslint-disable-line complexity\n\t/* Options\n\t/* ====================================================================== */\n\n\tconst self = this;\n\tconst opts = Object(rawopts);\n\tconst prefix = opts.prefix || 'media';\n\tconst lang = Object(opts.lang);\n\tconst svgs = Object(opts.svgs);\n\n\tconst timeDir = opts.timeDir || 'ltr';\n\tconst volumeDir = opts.volumeDir || 'ltr';\n\n\t/* Elements\n\t/* ====================================================================== */\n\n\tconst document = media.ownerDocument;\n\n\tself.media = $(media, {\n\t\tcanplaythrough: onCanPlayStart,\n\t\tloadstart: onLoadStart,\n\t\tloadeddata: onLoadedData,\n\t\tpause: onPlayChange,\n\t\tplay: onPlayChange,\n\t\ttimeupdate: onTimeChange,\n\t\tvolumechange: onVolumeChange\n\t});\n\n\t// play/pause toggle\n\tself.playSymbol = svg(prefix, svgs, 'play');\n\tself.pauseSymbol = svg(prefix, svgs, 'pause');\n\tself.play = $('button', { class: `${prefix}-control ${prefix}-play`, click: onPlayClick, keydown: onTimeKeydown }, self.playSymbol, self.pauseSymbol);\n\n\t// time slider\n\tself.timeMeter = $('span', { class: `${prefix}-meter ${prefix}-time-meter` });\n\tself.timeRange = $('span', { class: `${prefix}-range ${prefix}-time-range` }, self.timeMeter);\n\tself.time = $('button', { class: `${prefix}-slider ${prefix}-time`, role: 'slider', 'aria-label': lang.currentTime || 'current time', 'data-dir': timeDir, click: onTimeClick, keydown: onTimeKeydown }, self.timeRange);\n\n\t// current time text\n\tself.currentTimeText = document.createTextNode('');\n\tself.currentTime = $('span', { class: `${prefix}-text ${prefix}-current-time`, role: 'timer', 'aria-label': lang.currentTime || 'current time' }, self.currentTimeText);\n\n\t// remaining time text\n\tself.remainingTimeText = document.createTextNode('');\n\tself.remainingTime = $('span', { class: `${prefix}-text ${prefix}-remaining-time`, role: 'timer', 'aria-label': lang.remainingTime || 'remaining time' }, self.remainingTimeText);\n\n\t// mute/unmute toggle\n\tself.muteSymbol = svg(prefix, svgs, 'mute');\n\tself.unmuteSymbol = svg(prefix, svgs, 'unmute');\n\tself.mute = $('button', { class: `${prefix}-control ${prefix}-mute`, click: onMuteClick, keydown: onVolumeKeydown }, self.muteSymbol, self.unmuteSymbol);\n\n\t// volume slider\n\tself.volumeMeter = $('span', { class: `${prefix}-meter ${prefix}-volume-meter` });\n\tself.volumeRange = $('span', { class: `${prefix}-range ${prefix}-volume-range` }, self.volumeMeter);\n\tself.volume = $('button', { class: `${prefix}-slider ${prefix}-volume`, role: 'slider', 'aria-label': lang.volume || 'volume', 'data-dir': volumeDir, click: onVolumeClick, keydown: onVolumeKeydown }, self.volumeRange);\n\n\t// download link\n\tself.downloadLink = svg(prefix, svgs, 'download');\n\tself.download = $('button', { class: `${prefix}-control ${prefix}-download`, 'aria-label': lang.download || 'download', click: onDownloadClick }, self.downloadLink);\n\n\t// fullscreen link\n\tself.enterFullscreenSymbol = svg(prefix, svgs, 'enterFullscreen');\n\tself.leaveFullscreenSymbol = svg(prefix, svgs, 'leaveFullscreen');\n\tself.fullscreen = $('button', { class: `${prefix}-control ${prefix}-fullscreen`, click: onFullscreenClick }, self.enterFullscreenSymbol, self.leaveFullscreenSymbol);\n\n\t// player toolbar\n\tself.toolbar = $('div',\n\t\t{ class: `${prefix}-toolbar`, role: 'toolbar', 'aria-label': lang.player || 'media player' },\n\t\tself.play, self.mute,self.volume, self.currentTime, self.time, self.remainingTime, self.download, self.fullscreen\n\t);\n\n\t// player\n\tconst player = self.player = $('div', { class: `${prefix}-player`, role: 'region', 'aria-label': lang.player || 'media player' }, self.toolbar);\n\n\t// fullscreen api\n\tconst fullscreenchange = self._fullscreenchange = 'onfullscreenchange' in player ? 'fullscreenchange' : 'onwebkitfullscreenchange' in player ? 'webkitfullscreenchange' : 'onmozfullscreenchange' in player ? 'mozfullscreenchange' : 'onMSFullscreenChange' in player ? 'MSFullscreenChange' : 'fullscreenchange';\n\tconst fullscreenElement = self._fullscreenElement = () => document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement;\n\tconst requestFullscreen = self._requestFullscreen = player.requestFullscreen || player.webkitRequestFullscreen || player.mozRequestFullScreen || player.msRequestFullscreen;\n\tconst exitFullscreen = self._exitFullscreen = () => document.exitFullscreen || document.webkitCancelFullScreen || document.mozCancelFullScreen || document.msExitFullscreen;\n\n\t// listen for fullscreen changes\n\tdocument.addEventListener(fullscreenchange, onFullscreenChange);\n\n\t// update media class and controls\n\t$(media, { class: `${prefix}-media`, playsinline: '', 'webkit-playsinline': '', role: 'img', tabindex: -1 }).controls = false;\n\n\t// replace the media element with the media player\n\tif (media.parentNode) {\n\t\tplayer.insertBefore(\n\t\t\tmedia.parentNode.replaceChild(player, media),\n\t\t\tself.toolbar\n\t\t);\n\t}\n\n\t/* Interval Events\n\t/* ====================================================================== */\n\n\tlet paused, currentTime, duration, interval;\n\n\t// when the play state changes\n\tfunction onPlayChange() {\n\t\tif (paused !== media.paused) {\n\t\t\tpaused = media.paused;\n\n\t\t\t$(self.play, { 'aria-label': paused ? lang.play || 'play' : lang.pause || 'pause' });\n\t\t\t$(self.playSymbol, { 'aria-hidden': !paused });\n\t\t\t$(self.pauseSymbol, { 'aria-hidden': paused });\n\n\t\t\tclearInterval(interval);\n\n\t\t\tif (!paused) {\n\t\t\t\t// listen for time changes every 30th of a second\n\t\t\t\tinterval = setInterval(onTimeChange, 34);\n\t\t\t}\n\n\t\t\t// dispatch new \"playchange\" event\n\t\t\tdispatchCustomEvent(media, 'playchange');\n\t\t}\n\t}\n\n\t// when the time changes\n\tfunction onTimeChange() {\n\t\tif (currentTime !== media.currentTime || duration !== media.duration) {\n\t\t\tcurrentTime = media.currentTime;\n\t\t\tduration = media.duration || 0;\n\n\t\t\tconst currentTimePercentage = currentTime / duration;\n\t\t\tconst currentTimeCode = timeToTimecode(currentTime);\n\t\t\tconst remainingTimeCode = timeToTimecode(duration - Math.floor(currentTime));\n\n\t\t\tif (currentTimeCode !== self.currentTimeText.nodeValue) {\n\t\t\t\tself.currentTimeText.nodeValue = currentTimeCode;\n\n\t\t\t\t$(self.currentTime, { title: `${timeToAural(currentTime, lang.minutes || 'minutes', lang.seconds || 'seconds')}` });\n\t\t\t}\n\n\t\t\tif (remainingTimeCode !== self.remainingTimeText.nodeValue) {\n\t\t\t\tself.remainingTimeText.nodeValue = remainingTimeCode;\n\n\t\t\t\t$(self.remainingTime, { title: `${timeToAural(duration - currentTime, lang.minutes || 'minutes', lang.seconds || 'seconds')}` });\n\t\t\t}\n\n\t\t\t$(self.time, { 'aria-valuenow': currentTime, 'aria-valuemin': 0, 'aria-valuemax': duration });\n\n\t\t\tconst dirIsInline = /^(ltr|rtl)$/i.test(timeDir);\n\t\t\tconst axisProp = dirIsInline ? 'width' : 'height';\n\n\t\t\tself.timeMeter.style[axisProp] = `${currentTimePercentage * 100}%`;\n\n\t\t\t// dispatch new \"timechange\" event\n\t\t\tdispatchCustomEvent(media, 'timechange');\n\t\t}\n\t}\n\n\t// when media loads for the first time\n\tfunction onLoadStart() {\n\t\tmedia.removeEventListener('canplaythrough', onCanPlayStart);\n\n\t\t$(media, { canplaythrough: onCanPlayStart });\n\n\t\t$(self.download, { href: media.src, download: media.src });\n\n\t\tonPlayChange();\n\t\tonVolumeChange();\n\t\tonFullscreenChange();\n\t\tonTimeChange();\n\t}\n\n\t// when the immediate current playback position is available\n\tfunction onLoadedData() {\n\t\tonTimeChange();\n\t}\n\n\t// when the media can play\n\tfunction onCanPlayStart() {\n\t\tmedia.removeEventListener('canplaythrough', onCanPlayStart);\n\n\t\t// dispatch new \"canplaystart\" event\n\t\tdispatchCustomEvent(media, 'canplaystart');\n\n\t\tif (!paused || media.autoplay) {\n\t\t\tmedia.play();\n\t\t}\n\t}\n\n\t// when the volume changes\n\tfunction onVolumeChange() {\n\t\tconst volumePercentage = media.muted ? 0 : media.volume;\n\t\tconst isMuted = !volumePercentage;\n\n\t\t$(self.volume, { 'aria-valuenow': volumePercentage, 'aria-valuemin': 0, 'aria-valuemax': 1 });\n\n\t\tconst dirIsInline = /^(ltr|rtl)$/i.test(volumeDir);\n\t\tconst axisProp = dirIsInline ? 'width' : 'height';\n\n\t\tself.volumeMeter.style[axisProp] = `${volumePercentage * 100}%`;\n\n\t\t$(self.mute, { 'aria-label': isMuted ? lang.unmute || 'unmute' : lang.mute || 'mute' });\n\t\t$(self.muteSymbol, { 'aria-hidden': isMuted });\n\t\t$(self.unmuteSymbol, { 'aria-hidden': !isMuted });\n\t}\n\n\tfunction onFullscreenChange() {\n\t\tconst isFullscreen = player === fullscreenElement();\n\n\t\t$(self.fullscreen, { 'aria-label': isFullscreen ? lang.leaveFullscreen || 'leave full screen' : lang.enterFullscreen || 'enter full screen' });\n\t\t$(self.enterFullscreenSymbol, { 'aria-hidden': isFullscreen });\n\t\t$(self.leaveFullscreenSymbol, { 'aria-hidden': !isFullscreen });\n\t}\n\n\t/* Input Events\n\t/* ====================================================================== */\n\n\t// when the play control is clicked\n\tfunction onPlayClick(event) {\n\t\tevent.preventDefault();\n\n\t\tmedia[media.paused ? 'play' : 'pause']();\n\t}\n\n\t// when the time control\n\tfunction onTimeClick(event) {\n\t\t// handle click if clicked without pointer\n\t\tif (!event.pointerType && !event.detail) {\n\t\t\tonPlayClick(event);\n\t\t}\n\t}\n\n\t// click from mute control\n\tfunction onMuteClick(event) {\n\t\tevent.preventDefault();\n\n\t\tmedia.muted = !media.muted;\n\t}\n\n\t// click from volume control\n\tfunction onVolumeClick(event) {\n\t\t// handle click if clicked without pointer\n\t\tif (!event.pointerType && !event.detail) {\n\t\t\tonMuteClick(event);\n\t\t}\n\t}\n\n\t// click from download control\n\tfunction onDownloadClick() {\n\t\tconst a = document.head.appendChild($('a', { download: '', href: media.src }));\n\n\t\ta.click();\n\n\t\tdocument.head.removeChild(a);\n\t}\n\n\t// click from fullscreen control\n\tfunction onFullscreenClick() {\n\t\tif (requestFullscreen) {\n\t\t\tif (player === fullscreenElement()) {\n\t\t\t\t// exit fullscreen\n\t\t\t\texitFullscreen().call(document);\n\t\t\t} else {\n\t\t\t\t// enter fullscreen\n\t\t\t\trequestFullscreen.call(player);\n\n\t\t\t\t// maintain focus in internet explorer\n\t\t\t\tself.fullscreen.focus();\n\n\t\t\t\t// maintain focus in safari\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tself.fullscreen.focus();\n\t\t\t\t}, 200);\n\t\t\t}\n\t\t} else if (media.webkitSupportsFullscreen) {\n\t\t\t// iOS allows fullscreen of the video itself\n\t\t\tif (media.webkitDisplayingFullscreen) {\n\t\t\t\t// exit ios fullscreen\n\t\t\t\tmedia.webkitExitFullscreen();\n\t\t\t} else {\n\t\t\t\t// enter ios fullscreen\n\t\t\t\tmedia.webkitEnterFullscreen();\n\t\t\t}\n\n\t\t\tonFullscreenChange();\n\t\t}\n\t}\n\n\t// keydown from play control or current time control\n\tfunction onTimeKeydown(event) {\n\t\tconst { keyCode, shiftKey } = event;\n\n\t\t// 37: LEFT, 38: UP, 39: RIGHT, 40: DOWN\n\t\tif (37 <= keyCode && 40 >= keyCode) {\n\t\t\tevent.preventDefault();\n\n\t\t\tconst isLTR = /^(btt|ltr)$/.tests(timeDir);\n\t\t\tconst offset = 37 === keyCode || 39 === keyCode ? keyCode - 38 : keyCode - 39;\n\n\t\t\tmedia.currentTime = Math.max(0, Math.min(duration, currentTime + offset * (isLTR ? 1 : -1) * (shiftKey ? 10 : 1)));\n\n\t\t\tonTimeChange();\n\t\t}\n\t}\n\n\t// keydown from mute control or volume control\n\tfunction onVolumeKeydown(event) {\n\t\tconst { keyCode, shiftKey } = event;\n\n\t\t// 37: LEFT, 38: UP, 39: RIGHT, 40: DOWN\n\t\tif (37 <= keyCode && 40 >= keyCode) {\n\t\t\tevent.preventDefault();\n\n\t\t\tconst isLTR = /^(btt|ltr)$/.tests(volumeDir);\n\t\t\tconst offset = 37 === keyCode || 39 === keyCode ? keyCode - 38 : isLTR ? 39 - keyCode : keyCode - 39;\n\n\t\t\tmedia.volume = Math.max(0, Math.min(1, media.volume + offset * (isLTR ? 0.1 : -0.1) * (shiftKey ? 1 : 0.2)));\n\t\t}\n\t}\n\n\t// pointer events from time control\n\tonDrag(self.time, self.timeRange, timeDir, (percentage) => {\n\t\tmedia.currentTime = duration * Math.max(0, Math.min(1, percentage));\n\n\t\tonTimeChange();\n\t});\n\n\t// pointer events from volume control\n\tonDrag(self.volume, self.volumeRange, volumeDir, (percentage) => {\n\t\tmedia.volume = Math.max(0, Math.min(1, percentage));\n\t});\n\n\tonLoadStart();\n}\n\n/* Handle Drag Ranges\n/* ========================================================================== */\n\nfunction onDrag(target, innerTarget, dir, listener) { // eslint-disable-line max-params\n\tconst hasPointerEvent = undefined !== target.onpointerup;\n\tconst hasTouchEvent   = undefined !== target.ontouchstart;\n\tconst pointerDown = hasPointerEvent ? 'pointerdown' : hasTouchEvent ? 'touchstart' : 'mousedown';\n\tconst pointerMove = hasPointerEvent ? 'pointermove' : hasTouchEvent ? 'touchmove' : 'mousemove';\n\tconst pointerUp   = hasPointerEvent ? 'pointerup'   : hasTouchEvent ? 'touchend' : 'mouseup';\n\n\t// ...\n\tconst dirIsInline = /^(ltr|rtl)$/i.test(dir);\n\tconst dirIsStart  = /^(ltr|ttb)$/i.test(dir);\n\n\t// ...\n\tconst axisProp = dirIsInline ? 'clientX' : 'clientY';\n\n\tlet window, start, end;\n\n\t// on pointer down\n\ttarget.addEventListener(pointerDown, onpointerdown);\n\n\tfunction onpointerdown(event) {\n\t\t// window\n\t\twindow = target.ownerDocument.defaultView;\n\n\t\t// client boundaries\n\t\tconst rect = innerTarget.getBoundingClientRect();\n\n\t\t// the container start and end coordinates\n\t\tstart = dirIsInline ? rect.left : rect.top;\n\t\tend   = dirIsInline ? rect.right : rect.bottom;\n\n\t\tonpointermove(event);\n\n\t\twindow.addEventListener(pointerMove, onpointermove);\n\t\twindow.addEventListener(pointerUp, onpointerup);\n\t}\n\n\tfunction onpointermove(event) {\n\t\t// prevent browser actions on this event\n\t\tevent.preventDefault();\n\n\t\t// the pointer coordinate\n\t\tconst position = axisProp in event ? event[axisProp] : event.touches && event.touches[0] && event.touches[0][axisProp] || 0;\n\n\t\t// the percentage of the pointer along the container\n\t\tconst percentage = (dirIsStart ? position - start : end - position) / (end - start);\n\n\t\t// call the listener with percentage\n\t\tlistener(percentage);\n\t}\n\n\tfunction onpointerup() {\n\t\twindow.removeEventListener(pointerMove, onpointermove);\n\t\twindow.removeEventListener(pointerUp, onpointerup);\n\t}\n}\n\n/* Time To Timecode\n/* ====================================================================== */\n\nfunction timeToTimecode(time) {\n\treturn `${`0${Math.floor(time / 60)}`.slice(-2)}:${`0${Math.floor(time % 60)}`.slice(-2)}`;\n}\n\n/* Time To Aural\n/* ====================================================================== */\n\nfunction timeToAural(time, langMinutes, langSeconds) {\n\treturn `${Math.floor(time / 60)} ${langMinutes}, ${Math.floor(time % 60)} ${langSeconds}`;\n}\n\n/* Update Elements\n/* ========================================================================== */\n\nfunction $(rawid) {\n\tconst id = rawid instanceof Node ? rawid : document.createElement(rawid);\n\tconst args = [].slice.call(arguments, 1);\n\n\tfor (let index in args) {\n\t\tif (args[index] instanceof Node) {\n\t\t\tid.appendChild(args[index]);\n\t\t} else if (Object(args[index]) === args[index]) {\n\t\t\tfor (let attr in args[index]) {\n\t\t\t\tif ('function' === typeof args[index][attr]) {\n\t\t\t\t\tid.addEventListener(attr, args[index][attr]);\n\t\t\t\t} else {\n\t\t\t\t\tid.setAttribute(attr, args[index][attr]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn id;\n}\n\nfunction svg(prefix, svgs, type) { // eslint-disable-line max-params\n\tconst svgns = 'http://www.w3.org/2000/svg';\n\tconst use = document.createElementNS(svgns, 'use');\n\n\tuse.setAttributeNS('http://www.w3.org/1999/xlink', 'href', svgs[type] || `#symbol-${type}`);\n\n\treturn $(document.createElementNS(svgns, 'svg'), {\n\t\tclass: `${prefix}-symbol ${prefix}-${type}-symbol`,\n\t\trole: 'presentation'\n\t}, use);\n}\n\n/* Dispatch Events\n/* ====================================================================== */\n\nfunction dispatchCustomEvent(node, type) {\n\tconst event = document.createEvent('CustomEvent');\n\n\tevent.initCustomEvent(type, true, true, undefined);\n\n\tnode.dispatchEvent(event);\n}\n"],"names":["onDrag","target","innerTarget","dir","listener","onpointermove","event","preventDefault","position","axisProp","touches","dirIsStart","start","end","onpointerup","removeEventListener","pointerMove","pointerUp","hasPointerEvent","undefined","hasTouchEvent","ontouchstart","pointerDown","dirIsInline","test","window","addEventListener","ownerDocument","defaultView","rect","getBoundingClientRect","left","top","right","bottom","timeToTimecode","time","Math","floor","slice","timeToAural","langMinutes","langSeconds","$","rawid","id","Node","document","createElement","args","call","arguments","index","appendChild","Object","attr","setAttribute","svg","prefix","svgs","type","svgns","use","createElementNS","setAttributeNS","dispatchCustomEvent","node","createEvent","initCustomEvent","dispatchEvent","media","rawopts","onPlayChange","paused","self","play","aria-label","lang","pause","playSymbol","aria-hidden","pauseSymbol","interval","setInterval","onTimeChange","currentTime","duration","currentTimePercentage","currentTimeCode","remainingTimeCode","currentTimeText","nodeValue","title","minutes","seconds","remainingTimeText","remainingTime","aria-valuenow","aria-valuemin","aria-valuemax","timeDir","timeMeter","style","onLoadStart","onCanPlayStart","canplaythrough","download","href","src","autoplay","onVolumeChange","volumePercentage","muted","volume","isMuted","volumeDir","volumeMeter","mute","unmute","muteSymbol","unmuteSymbol","onFullscreenChange","isFullscreen","player","fullscreenElement","fullscreen","leaveFullscreen","enterFullscreen","enterFullscreenSymbol","leaveFullscreenSymbol","onPlayClick","onMuteClick","onTimeKeydown","keyCode","shiftKey","isLTR","tests","offset","max","min","onVolumeKeydown","this","opts","class","click","keydown","timeRange","role","data-dir","pointerType","detail","createTextNode","volumeRange","downloadLink","a","head","removeChild","requestFullscreen","focus","webkitSupportsFullscreen","webkitDisplayingFullscreen","webkitExitFullscreen","webkitEnterFullscreen","toolbar","fullscreenchange","_fullscreenchange","_fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","_requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen","exitFullscreen","_exitFullscreen","webkitCancelFullScreen","mozCancelFullScreen","msExitFullscreen","playsinline","webkit-playsinline","tabindex","controls","parentNode","insertBefore","replaceChild","percentage"],"mappings":"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"}